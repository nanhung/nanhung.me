<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Acetaminophen-PBPK model • pksensi</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Acetaminophen-PBPK model">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pksensi</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pbpk_apap.html">Acetaminophen-PBPK model</a>
    </li>
    <li>
      <a href="../articles/pbtk1cpt.html">One-compartment PBTK model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nanhung/pksensi">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Acetaminophen-PBPK model</h1>
                        <h4 class="author">Nan-Hung Hsieh</h4>
            
            <h4 class="date">2019-01-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nanhung/pksensi/blob/master/vignettes/pbpk_apap.Rmd"><code>vignettes/pbpk_apap.Rmd</code></a></small>
      <div class="hidden name"><code>pbpk_apap.Rmd</code></div>

    </div>

    
    
<div id="uncertainty-and-sensitivity-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#uncertainty-and-sensitivity-analysis" class="anchor"></a>Uncertainty and sensitivity analysis</h2>
<p>The aim of this section is to reproduce our previous published <span class="citation">(Hsieh et al. 2018)</span> result of global sensitivity analysis for acetaminophen PBPK model through <code>pksensi</code>. The model codes are included in this package and can be generated through <code><a href="../reference/models.html">pbpk_apap_model()</a></code>. We applied the global sensitivity analysis workflow to the original published model with 21 model parameters <span class="citation">(Zurlinden and Reisfeld 2016)</span>. The descriptions of each parameter and the sampling ranges are list in Table 1.</p>
<table class="table">
<caption>
Table 1 Description of sampling range of model parameter
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Description
</th>
<th style="text-align:left;">
Unit
</th>
<th style="text-align:center;">
Min
</th>
<th style="text-align:center;">
Max
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Tg
</td>
<td style="text-align:left;">
Gatric emptying time constant
</td>
<td style="text-align:left;">
<span class="math inline">\(h\)</span>
</td>
<td style="text-align:center;">
-3.430
</td>
<td style="text-align:center;">
0.490
</td>
</tr>
<tr>
<td style="text-align:left;">
Tp
</td>
<td style="text-align:left;">
GI perfusion time constant
</td>
<td style="text-align:left;">
<span class="math inline">\(h\)</span>
</td>
<td style="text-align:center;">
-5.371
</td>
<td style="text-align:center;">
-1.451
</td>
</tr>
<tr>
<td style="text-align:left;">
CYP_Km
</td>
<td style="text-align:left;">
Cytochrome P450 metabolism, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
3.000
</td>
<td style="text-align:center;">
7.000
</td>
</tr>
<tr>
<td style="text-align:left;">
CYP_VmaxC
</td>
<td style="text-align:left;">
Cytochrome P450 metabolism, VMax
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{mole}/h\cdot{BW}^{0.75}\)</span>
</td>
<td style="text-align:center;">
-1.966
</td>
<td style="text-align:center;">
7.972
</td>
</tr>
<tr>
<td style="text-align:left;">
SULT_Km_apap
</td>
<td style="text-align:left;">
Sulfation pathway acetaminophen, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
3.744
</td>
<td style="text-align:center;">
7.664
</td>
</tr>
<tr>
<td style="text-align:left;">
SULT_Ki
</td>
<td style="text-align:left;">
Sulfation pathway substrate inhibition, Ki
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
4.305
</td>
<td style="text-align:center;">
8.225
</td>
</tr>
<tr>
<td style="text-align:left;">
SULT_Km_paps
</td>
<td style="text-align:left;">
Sulfation pathway PAPS, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
-3.000
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
SULT_VmaxC
</td>
<td style="text-align:left;">
Sulfation pathway acetaminophen, Vmax
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{mole}/h\cdot{BW}^{0.75}\)</span>
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
10.000
</td>
</tr>
<tr>
<td style="text-align:left;">
UGT_Km
</td>
<td style="text-align:left;">
Glucronidation pathway acetaminophen, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
6.740
</td>
<td style="text-align:center;">
10.660
</td>
</tr>
<tr>
<td style="text-align:left;">
UGT_Ki
</td>
<td style="text-align:left;">
Glucronidation pathway substrate inhibition, Ki
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
9.008
</td>
<td style="text-align:center;">
12.928
</td>
</tr>
<tr>
<td style="text-align:left;">
UGT_Km_GA
</td>
<td style="text-align:left;">
Glucronidation pathway GA, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(-\)</span>
</td>
<td style="text-align:center;">
-3.000
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
UGT_VmaxC
</td>
<td style="text-align:left;">
Glucronidation pathway acetaminophen, Vmax
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{mole}/h\cdot{BW}^{0.75}\)</span>
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
10.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Km_AG
</td>
<td style="text-align:left;">
APAP-G hepatic transporter, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
7.938
</td>
<td style="text-align:center;">
11.858
</td>
</tr>
<tr>
<td style="text-align:left;">
Vmax_AG
</td>
<td style="text-align:left;">
APAP-G hepatic transporter, Vmax
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{mole}/h\)</span>
</td>
<td style="text-align:center;">
6.994
</td>
<td style="text-align:center;">
14.997
</td>
</tr>
<tr>
<td style="text-align:left;">
Km_AS
</td>
<td style="text-align:left;">
APAP-S hepatic transporter, Km
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{M}\)</span>
</td>
<td style="text-align:center;">
8.000
</td>
<td style="text-align:center;">
12.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Vmax_AS
</td>
<td style="text-align:left;">
APAP-S hepatic transporter, Vmax
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu{mole}/h\)</span>
</td>
<td style="text-align:center;">
6.994
</td>
<td style="text-align:center;">
14.997
</td>
</tr>
<tr>
<td style="text-align:left;">
kGA_syn
</td>
<td style="text-align:left;">
UDPGA synthesis
</td>
<td style="text-align:left;">
<span class="math inline">\(1/h\)</span>
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
13.001
</td>
</tr>
<tr>
<td style="text-align:left;">
PAPS_syn
</td>
<td style="text-align:left;">
PAPS synthesis
</td>
<td style="text-align:left;">
<span class="math inline">\(1/h\)</span>
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
13.001
</td>
</tr>
<tr>
<td style="text-align:left;">
CLC_APAP
</td>
<td style="text-align:left;">
APAP clearance
</td>
<td style="text-align:left;">
<span class="math inline">\(L/h\cdot{BW}^{0.75}\)</span>
</td>
<td style="text-align:center;">
-5.999
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
CLC_AG
</td>
<td style="text-align:left;">
APAP-G clearance
</td>
<td style="text-align:left;">
<span class="math inline">\(L/h\cdot{BW}^{0.75}\)</span>
</td>
<td style="text-align:center;">
-5.999
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
CLC_AS
</td>
<td style="text-align:left;">
APAP-S clearance
</td>
<td style="text-align:left;">
<span class="math inline">\(L/h\cdot{BW}^{0.75}\)</span>
</td>
<td style="text-align:center;">
-5.999
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
</tbody>
</table>
<p>Same as the example of one-compartment PBTK model. The model parameter and the corresponding sampling range should be defined to create the parameter matrix. Previously, the probability distributions of model parameters were set to either truncated normal or uniform distribution when the parameters have informative prior information or not. To rapidly reach the acceptance convergence, we apply uniform distribution for all testing parameters. The ranges of informative parameters are set to 1.96-times difference for single side (approximate 54.6 times difference between minimum and maximum) under log-scaled. The nominal values of informative model parameters were defined as:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Nominal value</span></a>
<a class="sourceLine" id="cb1-2" title="2">Tg &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="fl">0.23</span>)</a>
<a class="sourceLine" id="cb1-3" title="3">Tp &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="fl">0.033</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">CYP_Km &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="dv">130</span>)</a>
<a class="sourceLine" id="cb1-5" title="5">SULT_Km_apap &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="dv">300</span>)</a>
<a class="sourceLine" id="cb1-6" title="6">SULT_Ki &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="dv">526</span>)</a>
<a class="sourceLine" id="cb1-7" title="7">SULT_Km_paps &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1-8" title="8">UGT_Km &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="fl">6.0e3</span>)</a>
<a class="sourceLine" id="cb1-9" title="9">UGT_Ki &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="fl">5.8e4</span>)</a>
<a class="sourceLine" id="cb1-10" title="10">UGT_Km_GA &lt;-<span class="kw">log</span>(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1-11" title="11">Km_AG &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="fl">1.99e4</span>)</a>
<a class="sourceLine" id="cb1-12" title="12">Km_AS &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="fl">2.29e4</span>)</a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14">rng &lt;-<span class="st"> </span><span class="fl">1.96</span> </a></code></pre></div>
<p>Generally, The wide range of parameter value might cause the computational error in the solver. One of the effective ways to prevent this problem is to adjust the value of relative and absolute error tolerance to control the error appearance by resetting these parameters in a lower value. The <code><a href="../reference/solve_mcsim.html">generate_infile()</a></code> provide the arguments of <code>rtol</code> and <code>atol</code> that can be adjusted to prevent the unwanted error. However, the modification will slow down the computational speed. Therefore, the alternative method to prevent the computational error is to detect the crucial parameter range that causes the problem. Also, setting the maximum number of (internally defined) steps to higher value instead of using the default value (500) can prevent this problem. The maximum number of step is set to 5000 in this case.</p>
<p>In this test case, we adjusted the range of <code>SULT_VmaxC</code> and <code>UGT_VmaxC</code> from U(0, 15) to U(0, 10). The relative and absolute error tolerance were set to 1e-7 and 1e-9, respectively, to prevent the computational error in MCSim,</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">params &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"lnTg"</span>, <span class="st">"lnTp"</span>, <span class="st">"lnCYP_Km"</span>,<span class="st">"lnCYP_VmaxC"</span>,</a>
<a class="sourceLine" id="cb2-2" title="2">           <span class="st">"lnSULT_Km_apap"</span>,<span class="st">"lnSULT_Ki"</span>,<span class="st">"lnSULT_Km_paps"</span>,<span class="st">"lnSULT_VmaxC"</span>,</a>
<a class="sourceLine" id="cb2-3" title="3">           <span class="st">"lnUGT_Km"</span>,<span class="st">"lnUGT_Ki"</span>,<span class="st">"lnUGT_Km_GA"</span>,<span class="st">"lnUGT_VmaxC"</span>,</a>
<a class="sourceLine" id="cb2-4" title="4">           <span class="st">"lnKm_AG"</span>,<span class="st">"lnVmax_AG"</span>,<span class="st">"lnKm_AS"</span>,<span class="st">"lnVmax_AS"</span>,</a>
<a class="sourceLine" id="cb2-5" title="5">           <span class="st">"lnkGA_syn"</span>,<span class="st">"lnkPAPS_syn"</span>, <span class="st">"lnCLC_APAP"</span>,<span class="st">"lnCLC_AG"</span>,<span class="st">"lnCLC_AS"</span>)</a>
<a class="sourceLine" id="cb2-6" title="6">q &lt;-<span class="st"> "qunif"</span></a>
<a class="sourceLine" id="cb2-7" title="7">q.arg &lt;-<span class="kw">list</span>(<span class="kw">list</span>(Tg<span class="op">-</span>rng, Tg<span class="op">+</span>rng),</a>
<a class="sourceLine" id="cb2-8" title="8">             <span class="kw">list</span>(Tp<span class="op">-</span>rng, Tp<span class="op">+</span>rng),</a>
<a class="sourceLine" id="cb2-9" title="9">             <span class="kw">list</span>(CYP_Km<span class="op">-</span>rng, CYP_Km<span class="op">+</span>rng),</a>
<a class="sourceLine" id="cb2-10" title="10">             <span class="kw">list</span>(<span class="op">-</span><span class="fl">2.</span>, <span class="fl">5.</span>),</a>
<a class="sourceLine" id="cb2-11" title="11">             <span class="kw">list</span>(SULT_Km_apap<span class="op">-</span>rng, SULT_Km_apap<span class="op">+</span>rng),</a>
<a class="sourceLine" id="cb2-12" title="12">             <span class="kw">list</span>(SULT_Ki<span class="op">-</span>rng, SULT_Ki<span class="op">+</span>rng),</a>
<a class="sourceLine" id="cb2-13" title="13">             <span class="kw">list</span>(SULT_Km_paps<span class="op">-</span>rng, SULT_Km_paps<span class="op">+</span>rng),</a>
<a class="sourceLine" id="cb2-14" title="14">             <span class="kw">list</span>(<span class="dv">0</span>, <span class="dv">10</span>),</a>
<a class="sourceLine" id="cb2-15" title="15">             <span class="kw">list</span>(UGT_Km<span class="op">-</span>rng, UGT_Km<span class="op">+</span>rng),</a>
<a class="sourceLine" id="cb2-16" title="16">             <span class="kw">list</span>(UGT_Ki<span class="op">-</span>rng, UGT_Ki<span class="op">+</span>rng),</a>
<a class="sourceLine" id="cb2-17" title="17">             <span class="kw">list</span>(UGT_Km_GA<span class="op">-</span>rng, UGT_Km_GA<span class="op">+</span>rng),</a>
<a class="sourceLine" id="cb2-18" title="18">             <span class="kw">list</span>(<span class="dv">0</span>, <span class="dv">10</span>),</a>
<a class="sourceLine" id="cb2-19" title="19">             <span class="kw">list</span>(Km_AG<span class="op">-</span>rng, Km_AG<span class="op">+</span>rng),</a>
<a class="sourceLine" id="cb2-20" title="20">             <span class="kw">list</span>(<span class="fl">7.</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb2-21" title="21">             <span class="kw">list</span>(Km_AS<span class="op">-</span>rng, Km_AS<span class="op">+</span>rng),</a>
<a class="sourceLine" id="cb2-22" title="22">             <span class="kw">list</span>(<span class="fl">7.</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb2-23" title="23">             <span class="kw">list</span>(<span class="fl">0.</span>, <span class="dv">13</span>),</a>
<a class="sourceLine" id="cb2-24" title="24">             <span class="kw">list</span>(<span class="fl">0.</span>, <span class="dv">13</span>),</a>
<a class="sourceLine" id="cb2-25" title="25">             <span class="kw">list</span>(<span class="op">-</span><span class="fl">6.</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-26" title="26">             <span class="kw">list</span>(<span class="op">-</span><span class="fl">6.</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-27" title="27">             <span class="kw">list</span>(<span class="op">-</span><span class="fl">6.</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-28" title="28"></a>
<a class="sourceLine" id="cb2-29" title="29">times &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">0.1</span>, <span class="dt">to =</span> <span class="fl">12.1</span>, <span class="dt">by =</span> <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb2-30" title="30"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb2-31" title="31">x &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rfast99.html">rfast99</a></span>(<span class="dt">params =</span> params, <span class="dt">n =</span> <span class="dv">512</span>, <span class="dt">q =</span> q, <span class="dt">q.arg =</span> q.arg, <span class="dt">replicate =</span> <span class="dv">10</span>) </a></code></pre></div>
<p>After creating the <code>pbpk_apap.model</code> in the working directory, the next step is to generate the executable files (<code>mcsim.pbpk_apap</code>) through <code><a href="../reference/compile_model.html">compile_model()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">mName &lt;-<span class="st"> "pbpk_apap"</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="../reference/models.html">pbpk_apap_model</a></span>()</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw"><a href="../reference/compile_model.html">compile_model</a></span>(mName, <span class="dt">application =</span> <span class="st">"mcsim"</span>)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; * Created executable file 'mcsim.pbpk_apap'.</span></a></code></pre></div>
<p>To improve the computational speed, this case only uses MCSim to estimate the concentration of acetaminophen (APAP) and its metabolites glucuronide (AG) and sulfate (AS) in plasma. The setting oral dose of APAP is 20 mg/kg in this example. Generally, the input dosing method can be defined through the <code>condition</code> argument. Since the unit of the given dose is mg/kg, the <code>mgkg_flag</code> is set to 1 to declare the statement. More definition of input can be found in the section of input functions in GNU MCSim User’s Manual (<a href="https://www.gnu.org/software/mcsim/mcsim.html#Input-functions" class="uri">https://www.gnu.org/software/mcsim/mcsim.html#Input-functions</a>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"lnCPL_APAP_mcgL"</span>, <span class="st">"lnCPL_AG_mcgL"</span>, <span class="st">"lnCPL_AS_mcgL"</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">conditions &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"mgkg_flag = 1"</span>,</a>
<a class="sourceLine" id="cb4-3" title="3">                <span class="st">"OralExp_APAP = NDoses(2, 1, 0, 0, 0.001)"</span>,</a>
<a class="sourceLine" id="cb4-4" title="4">                <span class="st">"OralDose_APAP_mgkg = 20.0"</span>)</a>
<a class="sourceLine" id="cb4-5" title="5"><span class="kw"><a href="../reference/solve_mcsim.html">generate_infile</a></span>(<span class="dt">params =</span> params,</a>
<a class="sourceLine" id="cb4-6" title="6">                <span class="dt">vars =</span> vars,</a>
<a class="sourceLine" id="cb4-7" title="7">                <span class="dt">time =</span> times, </a>
<a class="sourceLine" id="cb4-8" title="8">                <span class="dt">condition =</span> conditions,</a>
<a class="sourceLine" id="cb4-9" title="9">                <span class="dt">rtol =</span> <span class="fl">1e-7</span>, <span class="dt">atol =</span> <span class="fl">1e-9</span>)</a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; * Created input file "input.in".</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="kw">system.time</span>(y &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solve_mcsim.html">solve_mcsim</a></span>(x, <span class="dt">mName =</span> mName, </a>
<a class="sourceLine" id="cb4-12" title="12">                             <span class="dt">params =</span> params,</a>
<a class="sourceLine" id="cb4-13" title="13">                             <span class="dt">vars =</span> vars,</a>
<a class="sourceLine" id="cb4-14" title="14">                             <span class="dt">time =</span> times,</a>
<a class="sourceLine" id="cb4-15" title="15">                             <span class="dt">condition =</span> conditions,</a>
<a class="sourceLine" id="cb4-16" title="16">                             <span class="dt">generate.infile =</span> F))</a>
<a class="sourceLine" id="cb4-17" title="17"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">#&gt; 151.305   1.948 152.811</span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="kw"><a href="../reference/tell2.html">tell2</a></span>(x,y)</a></code></pre></div>
<p>The plotting function can output the result of time-dependent sensitivity measurement to determine the parameter impact on model output over time (Figure 1).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">plot</span>(x, <span class="dt">vars =</span> <span class="st">"lnCPL_AG_mcgL"</span>)</a></code></pre></div>
<div class="figure">
<img src="pbpk_apap_files/figure-html/unnamed-chunk-6-1.png" alt="Figure 1. " width="768"><p class="caption">
Figure 1.
</p>
</div>
<p>The uncertainty analysis is a crucial step before model calibration. We can apply uncertainty analysis through the <code><a href="../reference/pksim.html">pksim()</a></code> by the given name of output variables (Figure 2). Through this visualization approach, we can recognize whether the simulated outputs can accurately simulate the same concentration profile as the in-vivo experiment under the setting of parameter ranges. In Figure 2, all experiment points are included in the intervals, representing the acceptable set of the parameter range.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw"><a href="../reference/pksim.html">pksim</a></span>(y, <span class="dt">vars =</span> <span class="st">"lnCPL_APAP_mcgL"</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">text</span>(<span class="dv">1</span>, <span class="dv">15</span>, <span class="st">"APAP"</span>,<span class="dt">cex =</span> <span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw">points</span>(APAP<span class="op">$</span>Time, <span class="kw">log</span>(APAP<span class="op">$</span>APAP <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb6-5" title="5"><span class="kw"><a href="../reference/pksim.html">pksim</a></span>(y, <span class="dt">vars =</span> <span class="st">"lnCPL_AG_mcgL"</span>, <span class="dt">legend =</span> F)</a>
<a class="sourceLine" id="cb6-6" title="6"><span class="kw">text</span>(<span class="dv">1</span>, <span class="dv">15</span>, <span class="st">"AG"</span>,<span class="dt">cex =</span> <span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb6-7" title="7"><span class="kw">points</span>(APAP<span class="op">$</span>Time, <span class="kw">log</span>(APAP<span class="op">$</span>AG <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb6-8" title="8"><span class="kw"><a href="../reference/pksim.html">pksim</a></span>(y, <span class="dt">vars =</span> <span class="st">"lnCPL_AS_mcgL"</span>, <span class="dt">legend =</span> F)</a>
<a class="sourceLine" id="cb6-9" title="9"><span class="kw">text</span>(<span class="dv">1</span>, <span class="dv">15</span>, <span class="st">"AS"</span>,<span class="dt">cex =</span> <span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb6-10" title="10"><span class="kw">points</span>(APAP<span class="op">$</span>Time, <span class="kw">log</span>(APAP<span class="op">$</span>AS <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb6-11" title="11"><span class="kw">mtext</span>(<span class="st">"Time"</span>, SOUTH&lt;-<span class="dv">1</span>, <span class="dt">line=</span><span class="fl">0.4</span>, <span class="dt">cex=</span><span class="fl">1.2</span>, <span class="dt">outer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-12" title="12"><span class="kw">mtext</span>(<span class="st">"Conc."</span>, WEST&lt;-<span class="dv">2</span>, <span class="dt">line=</span><span class="fl">0.4</span>, <span class="dt">cex=</span><span class="fl">1.2</span>, <span class="dt">outer=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure">
<img src="pbpk_apap_files/figure-html/unnamed-chunk-7-1.png" alt="Figure 2. The range of model simulation based on parameter distribution" width="768"><p class="caption">
Figure 2. The range of model simulation based on parameter distribution
</p>
</div>
<p>In addition, through using the <code><a href="../reference/check.html">check()</a></code>, the parameter with sensitivity and convergence indices over the given condition can be easily detected for all output variables.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="../reference/check.html">check</a></span>(x)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt; Sensitivity check ( Index &gt; 0.05 )</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; ----------------------------------</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; First order:</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt;  lnTg lnTp lnSULT_VmaxC lnUGT_Km lnUGT_VmaxC lnKm_AG lnVmax_AG lnKm_AS lnVmax_AS lnkGA_syn lnkPAPS_syn lnCLC_APAP lnCLC_AG lnCLC_AS </span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; Interaction:</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt;  lnTg lnSULT_Km_apap lnSULT_VmaxC lnUGT_VmaxC lnVmax_AG lnVmax_AS lnkGA_syn lnkPAPS_syn lnCLC_APAP lnCLC_AG lnCLC_AS </span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt; Total order:</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt;  lnTg lnTp lnSULT_Km_apap lnSULT_VmaxC lnUGT_Km lnUGT_VmaxC lnKm_AG lnVmax_AG lnKm_AS lnVmax_AS lnkGA_syn lnkPAPS_syn lnCLC_APAP lnCLC_AG lnCLC_AS </span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">#&gt; Unselected factors in total order:</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#&gt;  lnCYP_Km lnCYP_VmaxC lnSULT_Ki lnSULT_Km_paps lnUGT_Ki lnUGT_Km_GA </span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">#&gt; Convergence check ( Index &gt; 0.05 )</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">#&gt; ----------------------------------</span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">#&gt; First order:</span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">#&gt;  lnTg lnTp lnSULT_VmaxC lnUGT_Km lnUGT_VmaxC lnVmax_AG lnKm_AS lnVmax_AS lnkGA_syn lnkPAPS_syn lnCLC_APAP lnCLC_AG lnCLC_AS </span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">#&gt; Interaction:</span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="co">#&gt;  lnSULT_Km_apap lnSULT_VmaxC lnUGT_VmaxC lnKm_AG lnVmax_AG lnKm_AS lnVmax_AS lnkGA_syn lnkPAPS_syn lnCLC_APAP lnCLC_AG lnCLC_AS </span></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-26" title="26"><span class="co">#&gt; Total order:</span></a>
<a class="sourceLine" id="cb7-27" title="27"><span class="co">#&gt;  lnTg lnTp lnSULT_Km_apap lnSULT_VmaxC lnUGT_Km lnUGT_VmaxC lnKm_AG lnVmax_AG lnKm_AS lnVmax_AS lnkGA_syn lnkPAPS_syn lnCLC_APAP lnCLC_AG lnCLC_AS</span></a></code></pre></div>
<p>The <code><a href="../reference/check.html">check()</a></code> also provides some feasible argument to specify the target output or change the cut-off value.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="../reference/check.html">check</a></span>(x, <span class="dt">vars =</span> <span class="st">"lnCPL_APAP_mcgL"</span>, <span class="dt">SI.cutoff =</span> <span class="fl">0.1</span>, <span class="dt">CI.cutoff =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; Sensitivity check ( Index &gt; 0.1 )</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; ----------------------------------</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; First order:</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt;  lnTg lnTp lnSULT_VmaxC lnCLC_APAP </span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; Interaction:</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt;  lnSULT_VmaxC lnkPAPS_syn </span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt; Total order:</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt;  lnTg lnTp lnSULT_VmaxC lnkPAPS_syn lnCLC_APAP </span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#&gt; Unselected factors in total order:</span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">#&gt;  lnCYP_Km lnCYP_VmaxC lnSULT_Km_apap lnSULT_Ki lnSULT_Km_paps lnUGT_Km lnUGT_Ki lnUGT_Km_GA lnUGT_VmaxC lnKm_AG lnVmax_AG lnKm_AS lnVmax_AS lnkGA_syn lnCLC_AG lnCLC_AS </span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">#&gt; Convergence check ( Index &gt; 0.1 )</span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">#&gt; ----------------------------------</span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co">#&gt; First order:</span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co">#&gt;  lnTg lnCLC_APAP </span></a>
<a class="sourceLine" id="cb8-22" title="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-23" title="23"><span class="co">#&gt; Interaction:</span></a>
<a class="sourceLine" id="cb8-24" title="24"><span class="co">#&gt;  lnkPAPS_syn </span></a>
<a class="sourceLine" id="cb8-25" title="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-26" title="26"><span class="co">#&gt; Total order:</span></a>
<a class="sourceLine" id="cb8-27" title="27"><span class="co">#&gt;  lnTg lnSULT_VmaxC lnkPAPS_syn lnCLC_APAP</span></a></code></pre></div>
</div>
<div id="heatmap-visualization-combined-with-an-index-cut-off" class="section level2">
<h2 class="hasAnchor">
<a href="#heatmap-visualization-combined-with-an-index-cut-off" class="anchor"></a>Heatmap visualization combined with an index “cut-off”</h2>
<p>Based on our previous study, we proposed the heatmap visualization approach to distinguish “influential” and “non-influential” parameters with a cut-off. Through the given argument <code>order</code>, we can select the specific order of sensitivity measurement that we’re interested in (Figure 3 &amp; 4).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="../reference/check.html">heat_check</a></span>(x, <span class="dt">order =</span> <span class="st">"interaction"</span>)</a></code></pre></div>
<p><img src="pbpk_apap_files/figure-html/Figure%203:%20Heatmap%20of%20sensitivity%20index%20for%20interaction-1.png" width="768"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="../reference/check.html">heat_check</a></span>(x, <span class="dt">order =</span> <span class="st">"total order"</span>)</a></code></pre></div>
<p><img src="pbpk_apap_files/figure-html/Figure%204:%20Heatmap%20of%20convergence%20index%20for%20total%20order-1.png" width="768"></p>
<p>Also, adding the <code>index = "CI"</code> in the function can further investigate the convergence of the sensitivity index. Based on the current setting of sampling number, most parameters cannot reach the acceptable criteria of convergence. Therefore, the higher number of sampling is necessary.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="../reference/check.html">heat_check</a></span>(x, <span class="dt">index =</span> <span class="st">"CI"</span>, <span class="dt">CI.cutoff =</span> <span class="fl">0.05</span>)</a></code></pre></div>
<p><img src="pbpk_apap_files/figure-html/Figure%205:%20Heatmap%20of%20convergence%20index-1.png" width="768"></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-fphar201800588">
<p>Hsieh, Nan-Hung, Brad Reisfeld, Frederic Y. Bois, and Weihsueh A. Chiu. 2018. “Applying a Global Sensitivity Analysis Workflow to Improve the Computational Efficiencies in Physiologically-Based Pharmacokinetic Modeling.” <em>Frontiers in Pharmacology</em> 9: 588. <a href="https://doi.org/10.3389/fphar.2018.00588">https://doi.org/10.3389/fphar.2018.00588</a>.</p>
</div>
<div id="ref-s13318-015-0253-x">
<p>Zurlinden, Todd J., and Brad Reisfeld. 2016. “Physiologically Based Modeling of the Pharmacokinetics of Acetaminophen and Its Major Metabolites in Humans Using a Bayesian Population Approach.” <em>European Journal of Drug Metabolism and Pharmacokinetics</em> 41: 267–80. <a href="https://doi.org/10.1007/s13318-015-0253-x">https://doi.org/10.1007/s13318-015-0253-x</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#uncertainty-and-sensitivity-analysis">Uncertainty and sensitivity analysis</a></li>
      <li><a href="#heatmap-visualization-combined-with-an-index-cut-off">Heatmap visualization combined with an index “cut-off”</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nan-Hung Hsieh, Brad Reisfeld, Weihsueh A. Chiu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
