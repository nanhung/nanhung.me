<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>One-compartment PBTK model • pksensi</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="One-compartment PBTK model">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pksensi</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pbpk_apap.html">Acetaminophen-PBPK model</a>
    </li>
    <li>
      <a href="../articles/pbtk1cpt.html">One-compartment PBTK model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nanhung/pksensi">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>One-compartment PBTK model</h1>
                        <h4 class="author">Nan-Hung Hsieh</h4>
            
            <h4 class="date">2019-01-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nanhung/pksensi/blob/master/vignettes/pbtk1cpt.Rmd"><code>vignettes/pbtk1cpt.Rmd</code></a></small>
      <div class="hidden name"><code>pbtk1cpt.Rmd</code></div>

    </div>

    
    
<div id="equations" class="section level2">
<h2 class="hasAnchor">
<a href="#equations" class="anchor"></a>Equations</h2>
<p>In this example, We use a simple, one-compartment PK model from <code>httk</code> package <span class="citation">(Pearce et al. 2017)</span> to demonstrate how <code>pksensi</code> can be applied to pharmacokinetic studies. The differential equations for the one-compartment pharmacokinetic model can be written as:</p>
<p><span class="math display">\[\frac{dA_{gutlumen}}{dt} = -k_{gutabs} \cdot A_{gutlumen} + g(t)\]</span> <span class="math display">\[\frac{dC_{rest}}{dt} = \frac{k_{gutabs}}{V_{dist}}-k_{elim} \cdot C_{rest}\]</span></p>
<p>where <span class="math inline">\(A_{gutlumen}\)</span> is the state variable that describes the quantity of compound in gut lumen (mol), <span class="math inline">\(k_{gutabs}\)</span> is the absorption rate constant that describes the chemical absorption from the gut lumen into gut tissue through first-order processes (/h), <span class="math inline">\(V_{dist}\)</span> is the volume of distribution (L), and <span class="math inline">\(k_{elim}\)</span> is the elimination rate constant (/h), which is equal to the total clearance divided by the volume of distribution. The time-dependent function <span class="math inline">\(g(t)\)</span> is used to describe the oral dosing schedule. <span class="math inline">\(C_{rest}\)</span> is the chemical concentration in plasma that can be used to compare with observed results in a pharmacokinetic experiment (mol/L).</p>
</div>
<div id="model-implementations-with-r-desolve-package" class="section level2">
<h2 class="hasAnchor">
<a href="#model-implementations-with-r-desolve-package" class="anchor"></a>Model implementations with R deSolve package</h2>
<p>In the beginning, we need to pre-install GNU MCSim <span class="citation">(Bois and Maszle 1997)</span> and related compiler to let us generate .c file and executable file. The GNU MCSim can be installed by following the instruction in GNU MCSim’s manual on <a href="https://www.gnu.org/software/mcsim/mcsim.html" class="uri">https://www.gnu.org/software/mcsim/mcsim.html</a> or using the build-in function <code><a href="../reference/mcsim.html">mcsim_install()</a></code> in <code>pksensi</code>. The GNU compiler is necessary for users that use Linux or MacOS. For Windows users, you should install Rtools on <a href="https://cran.r-project.org/bin/windows/Rtools/" class="uri">https://cran.r-project.org/bin/windows/Rtools/</a> and use <code>Sys.setenv()</code> to set the working path of compiler. The <code>Sys.which("gcc")</code> and <code>system('g++ -v')</code> can check whether we can run compiler correctly.</p>
<p>We first implemented this model in R by compiling the file written in C. pksensi allows users to select the preferred method to solve the pharmacokinetic model, either with the <code>deSolve</code> package or with GNU MCSim through the compile function. However, running model under GNU MCSim native code can have faster speed to obtain the model outputs.</p>
<p>The following R script can download and compile the model description file (<code>pbtk1cpt.model</code>) and use <code>deSolve</code> package <span class="citation">(Soetaert, Petzoldt, and Setzer 2010)</span> to solve ordinary differential equations in our model. The example model code of one-compartment PBTK model is available with pksensi package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="../reference/models.html">pbtk1cpt_model</a></span>()</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">cat</span>(<span class="kw">readLines</span>(<span class="st">"pbtk1cpt.model"</span>), <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">#&gt; # ------------------------------------------</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#&gt; # pbtk1cpt.model (Based on R httk package)</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#&gt; # ------------------------------------------</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; #</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt; States  = { Agutlument, Acompartment, Ametabolized, AUC};</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt; #</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt; Outputs = {Ccompartment};</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">#&gt; # Parameters</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">#&gt; vdist = 0;</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">#&gt; ke = 0;</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">#&gt; kgutabs = 1;</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co">#&gt; #</span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="co">#&gt; Dynamics {</span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="co">#&gt;   Ccompartment = Acompartment / vdist;</span></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="co">#&gt;   dt (Agutlument)  = - kgutabs * Agutlument;</span></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="co">#&gt;   dt (Acompartment)  = kgutabs * Agutlument - ke * Acompartment;</span></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="co">#&gt;   dt (Ametabolized) = ke * Acompartment;</span></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="co">#&gt;   dt (AUC) = Ccompartment;</span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="co">#&gt; End.</span></a></code></pre></div>
<p>Then, use <code><a href="../reference/compile_model.html">compile_model()</a></code> to generate the executable files (<code>pbtk1cpt.dll</code> on Windows or <code>pbtk1cpt.so</code> on other systems) and R file (<code>pbtk1cpt_inits.R</code>) with default input parameters and initial state settings with the definition of <code>application = "R"</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">mName &lt;-<span class="st"> "pbtk1cpt"</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="../reference/compile_model.html">compile_model</a></span>(mName, <span class="dt">application =</span> <span class="st">"R"</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt; * Created file 'pbtk1cpt.so'.</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw">source</span>(<span class="kw">paste0</span>(mName, <span class="st">"_inits.R"</span>))</a></code></pre></div>
<p>The parameter values and initial states can be customized to specify the properties and schedule for the given dosing scenario.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">parms &lt;-<span class="st"> </span><span class="kw">initParms</span>()</a>
<a class="sourceLine" id="cb3-2" title="2">parms[<span class="st">"vdist"</span>] &lt;-<span class="st"> </span><span class="fl">0.74</span></a>
<a class="sourceLine" id="cb3-3" title="3">parms[<span class="st">"ke"</span>] &lt;-<span class="st"> </span><span class="fl">0.28</span></a>
<a class="sourceLine" id="cb3-4" title="4">parms[<span class="st">"kgutabs"</span>] &lt;-<span class="st"> </span><span class="fl">2.18</span></a>
<a class="sourceLine" id="cb3-5" title="5">initState &lt;-<span class="st"> </span><span class="kw">initStates</span>(<span class="dt">parms=</span>parms)</a>
<a class="sourceLine" id="cb3-6" title="6">initState[<span class="st">"Agutlument"</span>] &lt;-<span class="st"> </span><span class="dv">10</span></a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">parms</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt;   vdist      ke kgutabs </span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt;    0.74    0.28    2.18</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">initState</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt;   Agutlument Acompartment Ametabolized          AUC </span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt;           10            0            0            0</span></a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">Outputs</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt; [1] "Ccompartment"</span></a></code></pre></div>
<p>In the current setting, we assumed the initial condition of the intake chemical to be 10 mol. The <code>initParms</code> and <code>initStates</code> functions were used to customize the parameter values and the initial state that will be used in the <code>solve_fun</code> function. These parameter value can be adopted from the <code>httk</code> package, which includes physico-chemical and drug biological properties for 553 chemicals. In this case, we used the parameter value of theophylline in this example. The given <code>vdist</code>, <code>ke</code>, and <code>kgutabs</code> are 0.74, 0.28, and 2.18, respectively.</p>
<p>Through <code>ode</code> function in <code>deSolve</code> package, we can visualize the pharmacokinetic according to the given parameter conditions such as time points (<code>times</code>):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">times &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">0.01</span>, <span class="dt">to =</span> <span class="fl">24.01</span>, <span class="dt">by =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">y &lt;-<span class="st"> </span>deSolve<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/deSolve/topics/ode">ode</a></span>(initState, times, <span class="dt">func =</span> <span class="st">"derivs"</span>, <span class="dt">parms =</span> parms, </a>
<a class="sourceLine" id="cb7-3" title="3">                  <span class="dt">dllname =</span> mName, <span class="dt">initfunc =</span> <span class="st">"initmod"</span>, <span class="dt">nout =</span> <span class="dv">1</span>, <span class="dt">outnames =</span> Outputs)</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">plot</span>(y)</a></code></pre></div>
<div class="figure">
<img src="pbtk1cpt_files/figure-html/unnamed-chunk-8-1.png" alt="Figure 1. Simulation results of one-compartment PBTK model." width="576"><p class="caption">
Figure 1. Simulation results of one-compartment PBTK model.
</p>
</div>
<p>To conduct sensitivity analysis for the parameters in one-compartment pharmacokinetic model in this case, we want to quantify the impact of these three parameters on the chemical concentration in plasma during 24-hour time period post intake. We assume a uniform distribution for the estimate for each parameter with the coefficient of uncertainty within 50%. The parameter ranges are assumed to be (0.37, 1.12) for <code>vdist</code>, (0.0058, 0.0174) for <code>ke</code>, and (0.045, 0.136) for <code>kgutabs</code>. The sample number determines the robustness of the result of sensitivity analysis. Higher sample numbers can generate narrow confidence intervals for sensitivity measurements across different replications. However, they might cause heavy computational burden for complex models. Here we use a sample number of 400 with 20 replications:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">LL &lt;-<span class="st"> </span><span class="fl">0.5</span> </a>
<a class="sourceLine" id="cb9-2" title="2">UL &lt;-<span class="st"> </span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb9-3" title="3">q &lt;-<span class="st"> "qunif"</span></a>
<a class="sourceLine" id="cb9-4" title="4">q.arg &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">min =</span> parms[<span class="st">"vdist"</span>] <span class="op">*</span><span class="st"> </span>LL, <span class="dt">max =</span> parms[<span class="st">"vdist"</span>] <span class="op">*</span><span class="st"> </span>UL),</a>
<a class="sourceLine" id="cb9-5" title="5">             <span class="kw">list</span>(<span class="dt">min =</span> parms[<span class="st">"ke"</span>] <span class="op">*</span><span class="st"> </span>LL, <span class="dt">max =</span> parms[<span class="st">"ke"</span>] <span class="op">*</span><span class="st"> </span>UL), </a>
<a class="sourceLine" id="cb9-6" title="6">             <span class="kw">list</span>(<span class="dt">min =</span> parms[<span class="st">"kgutabs"</span>] <span class="op">*</span><span class="st"> </span>LL, <span class="dt">max =</span> parms[<span class="st">"kgutabs"</span>] <span class="op">*</span><span class="st"> </span>UL)) </a>
<a class="sourceLine" id="cb9-7" title="7"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb9-8" title="8">params &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"vdist"</span>, <span class="st">"ke"</span>, <span class="st">"kgutabs"</span>)</a>
<a class="sourceLine" id="cb9-9" title="9">x &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rfast99.html">rfast99</a></span>(params, <span class="dt">n =</span> <span class="dv">200</span>, <span class="dt">q =</span> q, <span class="dt">q.arg =</span> q.arg, <span class="dt">replicate =</span> <span class="dv">20</span>)</a></code></pre></div>
<p>Because the pharmacokinetic model is being used to describe a continuous process for the chemical concentration over time, the sensitivity measurements can also show the time-dependent relationships for each model parameter. Here we define the output time points to examine the change of the parameter sensitivity over time. To solve the pharmacokinetic model through deSolve, we need to provide the details of the argument:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">y &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solve_fun.html">solve_fun</a></span>(x, times, <span class="dt">initState =</span> initState, <span class="dt">outnames =</span> Outputs, <span class="dt">dllname =</span> mName)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw"><a href="../reference/tell2.html">tell2</a></span>(x,y)</a></code></pre></div>
<p>To create the time-dependent sensitivity measurement, we set the time duration from 0.01 to 24.01 hours in the example. The <code>initParmsfun</code> is used to generate the sampling value for each parameter. The <code>outnames</code>, <code>dllname</code>, <code>func</code>, <code>initfunc</code> are based on the arguments from the ode function in <code>deSolve</code> package. The details of the model structure and these arguments are defined in <code>pbtk1comp.c</code>. and <code>pbtk1comp_inits.R</code>. Finally, the <code>tell2</code> function is used to integrate the parameter values and the output results of numerical analysis that were generated and stored in variables x and y. The result of object x is an object of rfast99, which has specific <code>print</code>, <code>plot</code>, and <code>check</code> method. The print function gives the sensitivity and convergence indices for main, interaction, and total order at each time point. In addition to print out the result of sensitivity analysis, the more efficient way to distinguish the influence of model parameter is to visualize them. The time-dependent sensitivity indices are shown in Figure 2.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">plot</span>(x)</a></code></pre></div>
<div class="figure">
<img src="pbtk1cpt_files/figure-html/unnamed-chunk-11-1.png" alt="Figure 2. Time-dependent sensitivity indices of the plasma concentration estimated from one-compartment PBTK model during 24 hour time period intake." width="576"><p class="caption">
Figure 2. Time-dependent sensitivity indices of the plasma concentration estimated from one-compartment PBTK model during 24 hour time period intake.
</p>
</div>
<p>Here, we can find that <code>vdist</code> and <code>ke</code> are dominating the plasma concentration in the before and after 5-hour post chemical intake, respectively, representing that the elimination is a key parameter to dominate the plasma concentration. Besides, the <code>kgutabs</code> only plays a crucial role to determine the plasma concentration in the first hour. The relationship between concentration and the parameters can be plotted as follow (Figure 3):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">"vdist"</span>], y[,<span class="dv">1</span>,<span class="st">"0.01"</span>,], <span class="dt">main =</span> <span class="st">"vdist"</span>)</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">text</span>(<span class="dv">1</span>, <span class="fl">.7</span>, <span class="st">"t=0.01"</span>,<span class="dt">cex =</span> <span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb12-4" title="4"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">"ke"</span>], y[,<span class="dv">1</span>,<span class="st">"0.01"</span>,], <span class="dt">main =</span> <span class="st">"ke"</span>)</a>
<a class="sourceLine" id="cb12-5" title="5"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">"kgutabs"</span>], y[,<span class="dv">1</span>,<span class="st">"0.01"</span>,], <span class="dt">main =</span> <span class="st">"kgutabs"</span>)</a>
<a class="sourceLine" id="cb12-6" title="6"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">"vdist"</span>], y[,<span class="dv">1</span>,<span class="st">"2.01"</span>,])</a>
<a class="sourceLine" id="cb12-7" title="7"><span class="kw">text</span>(<span class="dv">1</span>, <span class="dv">18</span>, <span class="st">"t=2.01"</span>,<span class="dt">cex =</span> <span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb12-8" title="8"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">"ke"</span>], y[,<span class="dv">1</span>,<span class="st">"2.01"</span>,])</a>
<a class="sourceLine" id="cb12-9" title="9"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">"kgutabs"</span>], y[,<span class="dv">1</span>,<span class="st">"2.01"</span>,])</a>
<a class="sourceLine" id="cb12-10" title="10"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">"vdist"</span>], y[,<span class="dv">1</span>,<span class="st">"24.01"</span>,])</a>
<a class="sourceLine" id="cb12-11" title="11"><span class="kw">text</span>(<span class="dv">1</span>, <span class="fl">.7</span>, <span class="st">"t=24.01"</span>,<span class="dt">cex =</span> <span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb12-12" title="12"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">"ke"</span>], y[,<span class="dv">1</span>,<span class="st">"24.01"</span>,])</a>
<a class="sourceLine" id="cb12-13" title="13"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">"kgutabs"</span>], y[,<span class="dv">1</span>,<span class="st">"24.01"</span>,])</a>
<a class="sourceLine" id="cb12-14" title="14"><span class="kw">mtext</span>(<span class="st">"parameter"</span>, SOUTH&lt;-<span class="dv">1</span>, <span class="dt">line=</span><span class="fl">0.4</span>, <span class="dt">outer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-15" title="15"><span class="kw">mtext</span>(<span class="st">"Ccompartment"</span>, WEST&lt;-<span class="dv">2</span>, <span class="dt">line=</span><span class="fl">0.4</span>, <span class="dt">outer=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure">
<img src="pbtk1cpt_files/figure-html/unnamed-chunk-12-1.png" alt="Figure 3. The relationship between model parameter and estimated concentration under the time-point of 0.01, 2.01, and 24.01 hr" width="576"><p class="caption">
Figure 3. The relationship between model parameter and estimated concentration under the time-point of 0.01, 2.01, and 24.01 hr
</p>
</div>
<p>The x is a list of class “rfast99”, containing all the input arguments detailed before and the calculated sensitivity indices of first order (<code>mSI</code>), interaction (<code>iSI</code>), and total order (<code>tSI</code>). The convergence indices are also stored in the list named <code>mCI</code>, <code>iCI</code>, and <code>tCI</code>. The parameter values are stored in an array <code>x$a</code> with c(model evaluation, replication, parameters).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">dim</span>(x<span class="op">$</span>a)</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">#&gt; [1] 600  20   3</span></a></code></pre></div>
<p>In addition, the output are also formated with c(model evaluation, replication, time, variable).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">dim</span>(y)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co">#&gt; [1] 600  20  25   1</span></a></code></pre></div>
<p>The <code><a href="../reference/check.html">check()</a></code> is a useful function to determine which parameters have relative lower sensitivity measurement across the given time interval, and therefore can be applied parameter fixing in model calibration. The argument of <code>SI.cutoff</code> is setting at 0.5 to detect the relative non-influential parameters in this case.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw"><a href="../reference/check.html">check</a></span>(x, <span class="dt">SI.cutoff =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co">#&gt; Sensitivity check ( Index &gt; 0.5 )</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co">#&gt; ----------------------------------</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="co">#&gt; First order:</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co">#&gt;  vdist ke </span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co">#&gt; Interaction:</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">#&gt;   </span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="co">#&gt; Total order:</span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co">#&gt;  vdist ke </span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="co">#&gt; Unselected factors in total order:</span></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="co">#&gt;  kgutabs </span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-18" title="18"><span class="co">#&gt; Convergence check ( Index &gt; 0.05 )</span></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="co">#&gt; ----------------------------------</span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="co">#&gt; First order:</span></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="co">#&gt;   </span></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-23" title="23"><span class="co">#&gt; Interaction:</span></a>
<a class="sourceLine" id="cb15-24" title="24"><span class="co">#&gt;   </span></a>
<a class="sourceLine" id="cb15-25" title="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb15-26" title="26"><span class="co">#&gt; Total order:</span></a>
<a class="sourceLine" id="cb15-27" title="27"><span class="co">#&gt; </span></a></code></pre></div>
<p>Based on the sensitivity measurement of the total order, the result shows that <code>kgutabs</code> has relative lower measurement of sensitivity index.</p>
</div>
<div id="model-implementations-with-gnu-mcsim" class="section level2">
<h2 class="hasAnchor">
<a href="#model-implementations-with-gnu-mcsim" class="anchor"></a>Model implementations with GNU MCSim</h2>
<p>Alternatively, to solve ODE by using GNU MCSim, we need to change the argument to <code>application = mcsim</code> in <code><a href="../reference/compile_model.html">compile_model()</a></code>. Rather than apply R <code>deSolve</code> to solve differential equations, the GNU MCSim can provide higher computational speed in global sensitivity analysis.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">system.time</span>(y&lt;-<span class="kw"><a href="../reference/solve_fun.html">solve_fun</a></span>(x, times, <span class="dt">initState =</span> initState, <span class="dt">outnames =</span> Outputs, <span class="dt">dllname =</span> mName))</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">#&gt;   5.671   0.025   5.711</span></a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw"><a href="../reference/compile_model.html">compile_model</a></span>(mName, <span class="dt">application =</span> <span class="st">"mcsim"</span>)</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co">#&gt; * Created executable file 'mcsim.pbtk1cpt'.</span></a></code></pre></div>
<p>Sililiar to <code>solve_fun</code> that can define the initial parameter and state values through input function, the <code>solve_mcsim</code> has a <code>condition</code> argument that is used to givien the specific input value such as oral dose or fixing parameter value or initial state variable.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">conditions &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Agutlument = 10"</span>) <span class="co"># Set the initial state of Agutlument = 10 </span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw">system.time</span>(y&lt;-<span class="kw"><a href="../reference/solve_mcsim.html">solve_mcsim</a></span>(x, <span class="dt">mName =</span> mName, </a>
<a class="sourceLine" id="cb18-3" title="3">                           <span class="dt">params =</span> params,</a>
<a class="sourceLine" id="cb18-4" title="4">                           <span class="dt">vars =</span> Outputs,</a>
<a class="sourceLine" id="cb18-5" title="5">                           <span class="dt">time =</span> times,</a>
<a class="sourceLine" id="cb18-6" title="6">                           <span class="dt">condition =</span> conditions))</a>
<a class="sourceLine" id="cb18-7" title="7"><span class="co">#&gt; * Created input file "input.in".</span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="co">#&gt;   1.609   0.081   1.523</span></a></code></pre></div>
<p>Under the same given condition, it takes 5-6 (<code>deSolve</code>) and 1-2 (GNU MCSim) seconds to solve model. The <code><a href="../reference/solve_mcsim.html">solve_mcsim()</a></code> shows the better computational performance than <code><a href="../reference/solve_fun.html">solve_fun()</a></code> in <code>pksensi</code>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-JSSv002i09">
<p>Bois, Frederic, and Don Maszle. 1997. “MCSim: A Monte Carlo Simulation Program.” <em>Journal of Statistical Software, Articles</em> 2 (9): 1–60. <a href="https://doi.org/10.18637/jss.v002.i09">https://doi.org/10.18637/jss.v002.i09</a>.</p>
</div>
<div id="ref-JSSv079i04">
<p>Pearce, Robert, R. Woodrow Setzer, Cory Strope, Nisha Sipes, and John Wambaugh. 2017. “httk: R Package for High-Throughput Toxicokinetics.” <em>Journal of Statistical Software, Articles</em> 79 (4): 1–26. <a href="https://doi.org/10.18637/jss.v079.i04">https://doi.org/10.18637/jss.v079.i04</a>.</p>
</div>
<div id="ref-JSSv033i09">
<p>Soetaert, Karline, Thomas Petzoldt, and R. Woodrow Setzer. 2010. “Solving Differential Equations in R: Package deSolve.” <em>Journal of Statistical Software, Articles</em> 33 (9): 1–25. <a href="https://doi.org/10.18637/jss.v033.i09">https://doi.org/10.18637/jss.v033.i09</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#equations">Equations</a></li>
      <li><a href="#model-implementations-with-r-desolve-package">Model implementations with R deSolve package</a></li>
      <li><a href="#model-implementations-with-gnu-mcsim">Model implementations with GNU MCSim</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nan-Hung Hsieh, Brad Reisfeld, Weihsueh A. Chiu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
