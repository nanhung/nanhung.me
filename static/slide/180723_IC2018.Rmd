---
title: Applying Global Sensitivity Analysis to Improve Computational Efficiency in Physiological-Based Pharmacokinetic Model
subtitle: "---"
author: "**Nan-Hung Hsieh, PhD**"
date: .small[Postdoctoral Research Associate @ Department of Veterinary Integrative Biosciences]
output: 
  xaringan::moon_reader:
    lib_dir: libs
    css: ["default", "tamu.css", "tamu-fonts.css"]
    nature:
      highlightLines: true
---

# About Me

### PhD in Bioenvironmental Systems Engineering (National Taiwan University)

```{r setup, include=FALSE}
htmltools::tagList(rmarkdown::html_dependency_font_awesome())
```

--

**My Research:** .bolder[Computational Toxicology] & .bolder[Risk Assessment]

--

**My Daily Work:**

.center[
<img src="http://whatmyfriendsthinkido.net/wp-content/uploads/2012/05/what-my-friends-think-I-do-what-i-actually-do-computer-programming.png" height="360px" />
]

---

# What is Pharmacokinetics (PK)

- Pharmacokinetics is the study of the fate of xenobiotics in a living organism.

- A xenobiotic is a chemical substance found within an organism that is not naturally produced or expected to be present within the organism

.center[![](https://media.springernature.com/original/springer-static/image/art%3A10.1007%2Fs00535-015-1061-4/MediaObjects/535_2015_1061_Fig1_HTML.gif)

.large[
**"PK"** focus on .bolder[DOSE] to .bolder[CONCENTRATION]
]
]

???
HISTORY OF PHARMACOKINETICS 

Pharmacokinetics has been defined in a number of ways. Literally, the word means the
application of kinetics to pharmakon, the Greek word for drugs and poisons. Kinetics is
that branch of knowledge which involves the change of one or more variables as a
function of time. 

---

background-image: url(http://www.mdpi.com/mca/mca-23-00027/article_deploy/html/images/mca-23-00027-g006.png)
background-size: 320px
background-position: 95% 5%

# Pharmacokinetics Model

- Pharmacokinetic modelling is performed to .large[.bolder["predict"]] the exposure  concentration in the .bolder[concentration-time] graph by constructing the .bolder[compartmental model].

- Include indformation for <strong>dose (_D_), concentration (*C*), time (*T*), and rate constant (*k*)</strong> in simulation. 

.shrink[
![](https://ars.els-cdn.com/content/image/1-s2.0-S1021949816301946-fx1_lrg.jpg)
]



---

## Physiological-Based Pharmacokinetic (PBPK) Model

Mathematically transcribing .bolder[anatomical, physiological, physical, and chemical] descriptions of the phenomena involved in the complex ADME processes.

.shrink[
![](http://pharmguse.net/pkdm/pbpm.jpg)
]


---

background-image: url(https://wol-prod-cdn.literatumonline.com/cms/attachment/87cce77b-8dd4-4928-869f-b230e0cffcc4/psp412134-fig-0003-m.jpg)
background-size: 540px
background-position: 90% 90%

# Why Pharmacokinetics modeling

- Pharmaceutical research

- Drug development

- Health risk assessment

        .  
        .  
        .  

---

# Challenge

.large[Currently, the **Bayesian Markov chain Monte Carlo algorithm** is a effective way to do PBPK model calibration. ]

.xlarge[.bolder[BUT]]

--

.large[
This method often have challenges in **"convergence"** with acceptable computational times due to the need to solve system equations in PBPK model. .bolder[(More parameters, More time!)]
]

.right[![](https://slides.yihui.name/gif/questions.gif)]

---

class: middle, center

### Sometimes, the result is bad ...

![](https://slides.yihui.name/gif/dump-computer.gif)

---

# Optimal solution - Parameter Fixing 

.large[We usually fix the **"possible"** non-influential model parameters through **"expert judgment"**.]

.xlarge[.bolder[BUT]]

--

.large[This approach might cause **bias** in parameter estimates and model predictions.]

.center[![](http://reliawiki.org/images/3/35/Doe34.png)]

---

# Propose solution for parameter fixing 

## "Global" Sensitivity Analysis

![](https://i.imgur.com/FjJIl7s.png)

---

# What/Why Global Sensitivity Analysis?

**"Global"** sensitivity analysis calculates the contribution from the variety of all model parameters, including 

- .bolder[Single parameter effects]
- .bolder[Multiple parameter interactions]

.pull-left[
**Local** (One-at-a-time)
![](http://evelynegroen.github.io/assets/images/fig11local.jpg)
]

.pull-right[
**Global** (All-at-a-time)
![](http://evelynegroen.github.io/assets/images/fig2global.jpg)
]

--

.center[**Global sensitivity analysis is good at** .bolder[parameter fixing]]

---

class: middle

# Hypothesis

.large[
.bolder[Global Sensitivity Analysis] can provide a systematic method to ascertain which PBPK model parameters have **negligible influence** on model outputs and can be fixed to improve computational speed in Bayesian parameter estimation with **minimal bias**.
]


.highlight[

**Question:**

1. .large[What] is the best sensitivity snalysis algorithm for PBPK model?

2. .large[Dose] global sensitivity analysis better than "expert decision"?

3. .large[Can] global sensitivity analysis provide the effective way in model calibration?

]


---

background-image: url(https://i.imgur.com/JjqgWwg.gif)
background-size: 320px
background-position: 90% 90%


# Materials

### PBPK Model ([Zurlinden and Reisfeld, 2016](https://link.springer.com/article/10.1007%2Fs13318-015-0253-x)): 

The simulation of the disposition of .bolder[acetaminophen (APAP)] and two of its key metabolites, .bolder[APAP-glucuronide (APAP-G)] and .bolder[APAP-sulfate (APAP-S)], in plasma, urine, and several pharmacologically and toxicologically relevant tissues.

<img src="https://i.imgur.com/uSCphVE.gif" height="350px" />

---

# Materials

### Experiment Data: 

Eight studies (n = 71) with single oral dose and three different given doses.

```{r, echo=F, eval=T}
Study <- c(1:8)
Dose <- c("325 mg", "1000 mg", "1000 mg", "1000 mg", "20 mg/kg", "20 mg/kg", "20 mg/kg", "20 mg/kg")
Subject <- c("8","6","5","12","8","6","11","9")
df <- data.frame(Study, Dose, Subject)
names(df) <- c("Study", "Dose", "No. of Subject")
knitr::kable(df, format = 'html', align=c("l","c","c"))
```

---

# Materials

### Sensitivity Analysis: 

**Local:** 

- Morris's algorithm

**Global:**  

- Extended Fourier Amplitude Sensitivity Testing (EFAST)

- Jansen's algorithm 

- Owen's algorithm


---

class: center

# Sensitivity Analysis (SA) Workflow


.large[Reproduce result from original paper (21 parameters)] 


<i class="fa fa-arrow-down"></i>


.large[Full model calibration (58 parameters)] 


<i class="fa fa-arrow-down"></i>

--

.highlight[
.large[Sensitivity Analysis using different sensitivity analysis algorithms]  
.left[
**Q1 - Compare the .bolder[time-cost and stability] under the same sample number**
]]

<i class="fa fa-arrow-down"></i>

.highlight[
.large[Model calibration by SA-judged influential parameters]   
.left[
**Q2 - Compare the .bolder[model performance] in accuracy and precision**  
**Q3 - Compare the .bolder[time-cost] in model calibration**
]]

---

## Q1 - What is the best SA algorithm for PBPK model?

### Time-spend in SA (min)

.center[.xlarge[
Morris (2.4) < .bolder[EFAST (19.8)] $\approx$ Jansen (19.8) < Owen (59.4)
]]

### Stability in SA (output variation)

.center[.xlarge[
Morris < .bolder[EFAST] < Jansen $\approx$  Owen
]]

### Reliability in parameter detecting (correlation across 4 methods)

.center[.xlarge[
.bolder[EFAST] $\approx$ Jansen $\approx$  Owen > Morris
]]

--

.large[
.center[
.highlight[
**Ans 1: .bolder[EFAST] gives the best result to detect parameter impact.**
]
We found **20** influential parameters by using EFAST.
]]



---

## Q2: Dose global SA better than "expert decision"?

- The .bolder[EFSAT] has better **precision** (high kurtosis) than expert decision
- The **accuracy** (residual mean $\approx$ 0) are very .bolder[similar] across three test methods

.center[
<img src="https://i.imgur.com/PKKfVDM.png" height="450px" />  
]

---

## Q2: Dose global SA better than "expert decision"?

.center[
<img src="https://i.imgur.com/vtvoHAX.png" height="450px" />  

.highlight[
**Ans 2: .bolder[EFAST]  was more effective than "expert judgment” at identifying parameters that are influential, and led to a better fitted results.** 
]]

---

## Q3: Can global SA provide the effective way in model calibration?

- Summary of the time-cost for expert-judged parameters ([Zurlinden and Reisfeld, 2016](https://link.springer.com/article/10.1007%2Fs13318-015-0253-x), 21), all model parameters (this study, 58), and EFAST-judged parameters (this study, 20)

```{r, echo=F, eval=T}
x <- c("All model parameters", "EFAST-judged parameters", "Expert-judged parameters")
y <- c("104.6 (0.96)", "42.1 (0.29)", "40.8 (0.18)")
df <- data.frame(x,y)
names(df) <- c("Parameter group","Time-cost in calibration (hr)")
knitr::kable(df, format = 'html', align=c("l","c"))
```

- All time-cost value are shown with mean and standard deviation (n = 10).

--

.center[
.highlight[
**Ans 3: Dimensionality reduction of PBPK model parameters by .bolder[EFAST] can substantially reduce computational time-cost while showing little change in model performance**. 
]]

---

# Take Home Message

If you want to do model calibration for PK or PBPK model, you can,

1. Use the .bolder[EFAST] to detect the **"influential"** model parameter.

1. Fix the **“non-influential”** parameters that were judged by EFAST.

1. Conduct model calibration for only the **“influential”** parameters.

.xlarge[
.bolder[And]
]

--

Cite this reference ... <i class="fa fa-smile-o"></i>  

Hsieh N-H, Reisfeld B, Bois FY and Chiu WA (2018) Applying a Global Sensitivity Analysis Workflow to Improve the Computational Efficiencies in Physiologically-Based Pharmacokinetic Modeling. Front. Pharmacol. 9:588. doi: 10.3389/fphar.2018.00588   
[link](https://www.frontiersin.org/articles/10.3389/fphar.2018.00588/full)  

.right[![](https://www.frontiersin.org/areas/journals/images/about-open-access.png)]


---

class: inverse, center

## Acknowledgements

**Supervisor**  
.large[Weihsueh A. Chiu] 

**Principal investigator**  
.large[Brad Reisfeld] 

**Software**  
.large[Frederic Y. Bois]

**PBPK model**  
.large[Todd Zurlinden]

<br />

### Fouder

<img src="https://www.fda.gov/ucm/groups/fdagov-public/documents/image/ucm519147.png" height="80px" /> 

---

# Reference

**Model calibration**

Bois, F. Y. (2009). GNU MCSim: Bayesian statistical inference for SBML-coded systems biology models. Bioinformatics 25, 1453–1454. doi: 10.1093/bioinformatics/btp162  
[link](https://doi.org/10.1093/bioinformatics/btp162)

**Idea of global SA-PBPK**

McNally, K., Cotton, R., and Loizou, G. D. (2011). A workflow for global sensitivity analysis of PBPK models. Front. Pharmacol. 2:31. doi: 10.3389/fphar.2011.00031   
[link](https://doi.org/10.3389/fphar.2011.00031)

**APAP-PBPK model details**

Zurlinden, T. J., and Reisfeld, B. (2016). Physiologically based modeling of the pharmacokinetics of acetaminophen and its major metabolites in humans using a Bayesian population approach. Eur. J. Drug Metab. Pharmacokinet. 41, 267–280. doi: 10.1007/s13318-015-0253-x   
[link](https://doi.org/10.1007/s13318-015-0253-x)

---

# Image source

[My Daily Work](http://whatmyfriendsthinkido.net/)

[What is Pharmacokinetics](https://link.springer.com/article/10.1007/s00535-015-1061-4)

[Pharmacokinetics Model - 1](https://www.sciencedirect.com/science/article/pii/S1021949816301946#undfig1)

[Pharmacokinetics Model - 2](http://www.mdpi.com/2297-8747/23/2/27)

[Physiological-Based Pharmacokinetic (PBPK) Model](http://pharmguse.net/pkdm/prediction.html)

[Why Pharmacokinetics modeling](https://ascpt.onlinelibrary.wiley.com/doi/abs/10.1002/psp4.12134)

[Optimal solution - Parameter Fixing](http://reliawiki.org/index.php/Statistical_Background_on_DOE)

["Global" Sensitivity Analysis](https://en.wikipedia.org/wiki/Sensitivity_analysis)

[What/Why Global Sensitivity Analysis?](http://evelynegroen.github.io/introduction/Introduction.html)

[GIF](https://yihui.name/)

---

# Thanks!

### More info: <i class="fa fa-home"></i> https://nanhung.me

### Slides at  

![](https://i.imgur.com/LRrz43H.png)

???

ENDENDENDENDENDENDENDENDENDENDENDENDENDENDENDENDENDENDENDENDENDEND
